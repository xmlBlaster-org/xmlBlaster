THIS CODE IS NOT FINISHED, IT IS NOT FUNCTIONAL YET!
2003-10-01 marcel

This simple client code shall allow applets to connect
to xmlBlaster and receive instant callback messages
with a persistent http connection.

The applet XmlBlasterApplet.java is a demo applet showing
how to do it.

Compile:

  build.sh all

Deploy to tomcat:

  build.sh deploy_war

Start the applet in a browser:

  http://localhost:8080/xmlBlaster/BasicApplet.html


A similar approach we have implemented for a browser without an applet,
using the same servlets:
See: http://www.xmlblaster.org/xmlBlaster/doc/requirements/client.browser.html
     http://www.xmlblaster.org/xmlBlaster/demo/http/index.html
     http://www.xmlblaster.org/xmlBlaster/doc/howto/http/http_tutorial.html


Flow:
=====

SEND GET: create my sessionId
 http://localhost:8080/xmlBlaster/BlasterHttpProxyServlet?ActionType=dummyToCreateASessionId
RCV:
 ...
 <body text='white' bgcolor='white'>Empty response for your ActionType='dummyToCreateASessionId' ...</body>

SEND GET: login (will never return -> persistent http)
 http://localhost:8080/xmlBlaster/BlasterHttpProxyServlet?ActionType=login&xmlBlaster.loginName=joe&xmlBlaster.passwd=secret
RCV:
 pings, callback messages etc.

   ----------------------------------------------------
   <!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN"><HTML>
   <HEAD>
      <meta http-equiv='Content-Type' content='text/html; charset=iso-8859-1'>
      <meta http-equiv='Pragma' content='no-cache'>
      <meta http-equiv='Cache-Control' content='no-cache'>
      <meta http-equiv='Expires' content='Tue, 31 Dec 1997 23:59:59 GMT'>
      <TITLE>BlasterHttpProxy Connection</TITLE>
   </HEAD>
   <BODY>
      <br>&nbsp;
      <br>&nbsp;
      <form ACTION="" METHOD="POST" TARGET="callback">
         <INPUT TYPE="HIDDEN" NAME="NoName" VALUE="NoValue" />
      </form>
      <script language='JavaScript'>
   if (parent.ping != null) parent.ping('refresh');
   </script><p />
   ----------------------------------------------------

RCV:
   ----------------------------------------------------
   <script language='JavaScript'>
   if (parent.ping != null) parent.ping('loginSucceeded');
   </script><p />
   ----------------------------------------------------

SEND POST:
   ----------------------------------------------------
   subscribe
   ----------------------------------------------------


Flow multipart:
===============

SEND GET:
 http://localhost:8080/xmlBlaster/BlasterHttpProxyServlet?ActionType=login&xmlBlaster.loginName=joe&xmlBlaster.passwd=secret

RCV:

PersistentRequest: Creating now a persistent connection to 'http://localhost:8080/xmlBlaster/BlasterHttpProxyServlet?ActionType=login&xmlBlaster.loginName=joe&xmlBlaster.passwd=secret'
PersistentRequest: Receiving: 
PersistentRequest: Receiving: --End
PersistentRequest: Receiving: Content-Type: text/html
PersistentRequest: Receiving: 
PersistentRequest: Receiving: <!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN"><HTML>
PersistentRequest: Receiving: <HEAD>
PersistentRequest: Receiving:    <meta http-equiv='Content-Type' content='text/html; charset=iso-8859-1'>
PersistentRequest: Receiving:    <meta http-equiv='Pragma' content='no-cache'>
PersistentRequest: Receiving:    <meta http-equiv='Cache-Control' content='no-cache'>
PersistentRequest: Receiving:    <meta http-equiv='Expires' content='Tue, 31 Dec 1997 23:59:59 GMT'>
PersistentRequest: Receiving:    <TITLE>BlasterHttpProxy Connection</TITLE>
PersistentRequest: Receiving: </HEAD>
PersistentRequest: Receiving: <BODY>
PersistentRequest: Receiving:    <br>&nbsp;
PersistentRequest: Receiving:    <br>&nbsp;
PersistentRequest: Receiving:    <form ACTION="" METHOD="POST" TARGET="callback">
PersistentRequest: Receiving:       <INPUT TYPE="HIDDEN" NAME="NoName" VALUE="NoValue" />
PersistentRequest: Receiving:    </form>
PersistentRequest: Receiving:    <script language='JavaScript'>
PersistentRequest: Receiving: if (parent.ping != null) parent.ping('refresh');
XmlBlasterAccessRaw: doPost=true, sending 'http://localhost:8080/xmlBlaster/BlasterHttpProxyServlet?ActionType=pong' ...
PersistentRequest: Receiving: </script>
PersistentRequest: Receiving: </BODY></HTML>
PersistentRequest: Receiving: 
PersistentRequest: Receiving: --End
PersistentRequest: Receiving: Content-Type: text/html
PersistentRequest: Receiving: 
PersistentRequest: Receiving: <!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN"><HTML>
PersistentRequest: Receiving: <HEAD>
PersistentRequest: Receiving:    <meta http-equiv='Content-Type' content='text/html; charset=iso-8859-1'>
PersistentRequest: Receiving:    <meta http-equiv='Pragma' content='no-cache'>
PersistentRequest: Receiving:    <meta http-equiv='Cache-Control' content='no-cache'>
PersistentRequest: Receiving:    <meta http-equiv='Expires' content='Tue, 31 Dec 1997 23:59:59 GMT'>
PersistentRequest: Receiving:    <TITLE>BlasterHttpProxy Connection</TITLE>
PersistentRequest: Receiving: </HEAD>
PersistentRequest: Receiving: <BODY>
PersistentRequest: Receiving:    <br>&nbsp;
PersistentRequest: Receiving:    <br>&nbsp;
PersistentRequest: Receiving:    <form ACTION="" METHOD="POST" TARGET="callback">
PersistentRequest: Receiving:       <INPUT TYPE="HIDDEN" NAME="NoName" VALUE="NoValue" />
PersistentRequest: Receiving:    </form>
PersistentRequest: Receiving:    <script language='JavaScript'>
PersistentRequest: Receiving: if (parent.ping != null) parent.ping('loginSucceeded');
PersistentRequest: Receiving: </script>
PersistentRequest: Receiving: </BODY></HTML>
PersistentRequest: Receiving: 
PersistentRequest: Receiving: --End
