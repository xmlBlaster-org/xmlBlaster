<?xml version='1.0' encoding='ISO-8859-1' ?>
<!DOCTYPE requirement SYSTEM "requirement.dtd">

<requirement id='client.failsave' type='NEW' prio='LOW' status="CLOSED">
   <topic>
      CorbaConnection is a java helper class for Java clients which supports
      polling for xmlBlaster and record/playback of messages during lost connections.
   </topic>
   <description>
      See CorbaConnection.java for a usage description and TestFailSave.java (testsuite)
      for a code example how to use it.
   </description>
   <example lang="Java">
      <![CDATA[<pre>
   public void login()
   {
      try {
         corbaConnection = new CorbaConnection(); // Hides Corba stuff

         // Setup fail save handling (optional) ...
         long retryInterval = 4000L; // if connection to xmlBlaster is lost,
                                     // polling frequency in milli seconds
         int retries = -1;           // -1 == forever
         int maxMessages = 1000;     // if connection to xmlBlaster is lost,
                                     // how many message to record locally and playback on reconnect
         long pingInterval = 2000L;
         corbaConnection.initFailSave(this, retryInterval, retries, maxMessages, pingInterval);

         corbaConnection.login(loginName, passwd, qos, this); // Login to xmlBlaster
      }
      catch (XmlBlasterException e) {
          System.out.println("Login failed, ID=" + e.id + " REASON=" + e.reason);
      }
   }

   /**
    * This is the callback method invoked from CorbaConnection
    * informing the client in an asynchronous mode if the connection was established.
    * This method is enforced through interface I_ConnectionProblems
    */
   public void reConnected()
   {
      // Code your recovery handling ...
      try {
         if (corbaConnection.queueSize() > 0) {
            corbaConnection.flushQueue();    // send all tailback messages
         }
      } catch (XmlBlasterException e) {
      }
   }

   /** listener callback allows to do actions if connection is lost */
   public void lostConnection()
   {
      System.out.println("Lost connection to xmlBlaster");
   }

      </pre>]]>
   </example>
   <author>ruff@swand.lake.de</author>
   <date>2000 02 23</date>
   <revision>$Revision: 1.3 $</revision>
   <testcase status="CLOSED">
      <name>-</name>
      <comment>-</comment>
      <test tool="SUITE">testsuite.org.xmlBlaster.TestFailSave.testFailSave()</test>
   </testcase>
</requirement>

