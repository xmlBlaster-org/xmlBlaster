<?xml version='1.0' encoding='ISO-8859-1' ?>
<!DOCTYPE requirement SYSTEM "requirement.dtd">

<requirement id='dispatch.plugin.priorizedDelivery' type='NEW' prio='MEDIUM' status='INWORK'>
   <topic>XmlBlaster allows to control message delivery based on external states</topic>
   <description>
      <p>
      There are situations where you need to send messages with specific priorities
      only. Imagine you have a high performance connection (e.g. 2 MBit) between xmlBlaster cluster
      nodes or between an xmlBlaster server and a client. If the line drops your routers
      switch transparently to a fallback line (e.g. an ISDN 64 kBit connection over phone).
      </p>
      <p>
      You may want to send only high priority messages in this case. The router setup needs
      to notify xmlBlaster about the slow backup situation with a status message or some status
      event sent for example via telnet to xmlBlaster.
      </p>
      <p>
      This is a use case where this plugin comes into the game.
      </p>
      <p>
      </p>
   </description>
   <example lang="Java" type="HTML">

      <b>Here is an example configuration to setup the plugin for the above described scenario:</b>

      <pre>
&lt;msgDispatch defaultStatus='64k' defaultAction='send'>
   &lt;onStatus oid='_bandwidth.status' content='64k' defaultAction='discard'>
      &lt;action do='send'  ifPriority='7-9'/>
      &lt;action do='queue'  ifPriority='2-6'/>
      &lt;action do='destroy'  ifPriority='0-2'/>
   &lt;/onStatus>
   &lt;onStatus oid='_bandwidth.status' content='2M'>
      &lt;action do='send'  ifPriority='0-9'/>
   &lt;/onStatus>
&lt;/msgDispatch>
      </pre>

      <p>
      The notification of the bandwidth status of the connection is sent by a message
      with oid='_bandwidth.status'.
      The content of this message contains the connection status,
      here we expect the content <i>64k</i> in backup mode.
      </p>
      <p>
      If such a status message arrives, our plugin behaves as described by
      the &lt;action> tags. Messages with priority 7, 8 or 9 are sent nevertheless
      whereas messages with priority 2,3,4,5 or 6 are kept in the queue waiting for
      better times. All lower priority messages are just deleted silently.
      m
      </p>
   </example>

   <configuration where="server">
      <p>
      These parameters allow to configure priorized delivery plugin.
      </p>
      <table border="1">
         <tr>
            <th>Property</th>
            <th>Default</th>
            <th>Description</th>
            <th>Hot</th>
            <th>Impl</th>
         </tr>

         <tr>
            <td>PriorizedDeliveryPlugin.config</td>
            <td>See above configuration xml string</td>
            <td>Configure the plugin with an xml configuration string</td>
            <td><img src="ok.gif" border="0" alt="yes" /></td>
            <td><img src="ok.gif" border="0" alt="yes" /></td>
         </tr>
      </table>
   </configuration>

   <see type="API">org.xmlBlaster.util.dispatch.plugins.prio.PriorizedDeliveryPlugin</see>
   <see type="API">org.xmlBlaster.util.dispatch.plugins.prio.ConfigurationParser</see>
   <see type="API">org.xmlBlaster.util.I_Plugin</see>
   <see type="REQ">cluster</see>
   <author>xmlBlaster@marcelruff.info</author>
   <date>2002 10 16</date>
   <revision>$Revision: 1.3 $</revision>
   <testcase status="INWORK">
      <name>-</name>
      <comment>-</comment>
      <test tool="SUITE">org.xmlBlaster.test.dispatch.ConfigurationParserTest</test>
   </testcase>
</requirement>

